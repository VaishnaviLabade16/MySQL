SHOW DATABASES;
USE VAISHNAVI;
SHOW TABLES;
SELECT *FROM STUDENT1;
SELECT *FROM COURSE;
SELECT *FROM ENROLLMENT;
SELECT *FROM PAYMENT;
 SELECT * FROM STUDENT1 S WHERE MARKS > (SELECT AVG(MARKS) FROM STUDENT WHERE CLASS=S.CLASS);
  SELECT CLASS, MAX(MARKS) AS SECOND_HIGHEST FROM STUDENT1 S1 WHERE MARKS <(SELECT MAX(MARKS) FROM STUDENT1 S2 WHERE S1.CLASS = S2.CLASS)GROUP BY CLASS;
  SELECT * FROM STUDENT1 WHERE MARKS>ALL(SELECT MARKS FROM STUDENT1 WHERE CITY='PUNE');
  SELECT *FROM STUDENT1 WHERE STU_ID NOT IN(SELECT STU_ID FROM ENROLLMENT);
  SELECT STU_ID, COUNT(COURSE_ID) AS TOTAL_COURSE FROM ENROLLMENT GROUP BY STU_ID HAVING COUNT(COURSE_ID)>2;
  SELECT S.STU_NAME, C.COURSE_NAME,C.FEES FROM STUDENT1 S INNER JOIN ENROLLMENT E ON S.STU_ID=E.STU_ID INNER JOIN COURSE C ON E.COURSE_ID=C.COURSE_ID;
  SELECT S.STU_NAME,C.COURSE_NAME FROM STUDENT1 S LEFT JOIN ENROLLMENT E ON S.STU_ID=E.STU_ID LEFT JOIN COURSE C ON E.COURSE_ID=C.COURSE_ID;
  SELECT C.COURSE_NAME, COUNT(E.STU_ID) AS TOTAL_STUDENTS FROM COURSE C LEFT JOIN ENROLLMENT E ON C.COURSE_ID=E.COURSE_ID GROUP BY C.COURSE_NAME;
  SELECT STU_ID FROM ENROLLMENT E JOIN COURSE C ON E.COURSE_ID=C.COURSE_ID WHERE C.COURSE_NAME IN ('JAVA','PYTHON') GROUP BY STU_ID HAVING COUNT(DISTINCT C.COURSE_NAME)=2;
  SELECT STU_ID, SUM(AMOUNT) AS TOTAL_FEES FROM PAYMENT GROUP BY STU_ID;
  SELECT STU_NAME,CLASS,MARKS,RANK() OVER (PARTITION BY CLASS ORDER BY MARKS DESC) AS RANK_NO FROM STUDENT1;
   SELECT * FROM(SELECT STU_NAME,CLASS,MARKS,RANK() OVER (PARTITION BY CLASS ORDER BY MARKS DESC) AS RNK FROM STUDENT1)T WHERE RNK <= 3;
   SELECT SUM(MARKS) AS TOTAL_MARKS, AVG(MARKS) AS AVG_MARKS FROM STUDENT1;
   CREATE VIEW STUDENT_COURSE_FEES AS SELECT S.STU_NAME, C.COURSE_NAME,C.FEES FROM STUDENT1 S JOIN ENROLLMENT E ON S.STU_ID=E.STU_ID JOIN COURSE C ON E.COURSE_ID=C.COURSE_ID;
   CREATE VIEW TOP_SCORER AS SELECT * FROM STUDENT1 WHERE MARKS=(SELECT MAX(MARKS) FROM STUDENT1);
   CREATE INDEX idx_marks ON Student1(marks);
   SELECT STU_NAME,COUNT(*) FROM STUDENT1 GROUP BY STU_NAME HAVING COUNT(*)>1;
   